(function(e){function s(m,j,d){var k,f,p,i;function x(b){if(b.length){for(var q=[],g=[],h,i,f=0;f<b.length;f++){var a=b[f],c=a.retweeted_status?a.retweeted_status.user:a.user;a.author=a.from_user||c.screen_name;a.name=a.from_user_name||c.name;a.author_url="http://twitter.com/"+a.author;a.tweet=d.linkify?s(a.text):a.text;a.tweet_url="http://twitter.com/"+a.author+"/statuses/"+a.id_str;a.date=Date.parse(a.created_at.replace(/^([a-z]{3})( [a-z]{3} \d\d?)(.*)( \d{4})$/i,"$1,$2$4$3"));a.time=y(a.date);
a.avatar_url=a.profile_image_url||c.profile_image_url;a.avatar_mini_url=a.avatar_url.replace(/_normal/gi,"_mini");a.avatar_bigger_url=a.avatar_url.replace(/_normal/gi,"_bigger");a.avatar='<img src="'+a.avatar_url+'" alt="'+a.author+"'s avatar\" />";a.avatar_mini='<img src="'+a.avatar_mini_url+'" alt="'+a.author+"'s avatar\" />";a.avatar_bigger='<img src="'+a.avatar_bigger_url+'" alt="'+a.author+"'s avatar\" />";c=e(d.template.replace(/\{\{ ?([a-z_]+) ?\}\}/gi,function(b,d){return a[d]}))[0];a.date>
u?g.push(c):q.push(c);f||(i=a.date,h="author"!==k?!1:{username:a.author,name:a.user.name,url:a.author_url,description:a.user.description,website:a.user.url,followers:a.user.followers_count,avatar_url:a.avatar_url,avatar_mini_url:a.avatar_mini_url,avatar_bigger_url:a.avatar_bigger_url,avatar:a.avatar,avatar_mini:a.avatar_mini,avatar_bigger:a.avatar_bigger,last_tweet:a,location:a.user.location,tweets:a.user.statuses_count,following:a.user.friends_count})}u=i;v&&(v=0);b=e(g);q=b.add(q);b.hide();q.appendTo(n.empty());
b.fadeIn(1E3);n.trigger(l+":load",[q,b,h])}}function g(b){t=1;n.trigger(l+":fetch");e.getJSON(c+"?callback=?",r).always(function(){t=0}).fail(function(){h=setTimeout(g,2E3)}).done(function(c){x(c.results||c);0<d.refreshInterval&&!b&&(h=setTimeout(g,1E3*d.refreshInterval))})}function s(b){for(var c=[/[\@]+([A-Za-z0-9_\-]+)/gi,/(?:^| )[\#]+([A-Za-z0-9\-_]+)/gi,/((ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?)/g],d=['<a href="http://twitter.com/$1">@$1</a>',' <a href="http://twitter.com/search?q=%23$1">#$1</a>',
'<a href="$1">$1</a>'],e=c.length;0<e;)b=b.replace(c[--e],d[e]);return b}function y(b){var b=Math.abs(parseInt((+new Date-b)/1E3,10)),c="";return c=60>b?b+" seconds ago":120>b?"a minute ago":2700>b?parseInt(b/60,10)+" minutes ago":7200>b?"an hour ago":86400>b?parseInt(b/3600,10)+" hours ago":172800>b?"a day ago":parseInt(b/86400,10)+" days ago"}var z=this,n=e(m);i=p=f=k=void 0;var h=0,u=0,t=0,v=1,c,r,w;this.pause=function(){h?h=clearTimeout(h):d.refreshInterval&&g()};this.resume=function(){!h&&(h=
setTimeout(g,1E3*d.refreshInterval))};this.refresh=function(){t||(h&&clearTimeout(h),g(1))};this.destroy=function(){clearTimeout(h);e.removeData(m,o);n.unbind("."+o).html(w)};(function(){w=n.html();var b=0;null!==(b=/^@([a-z0-1._\-]+)$/i.exec(j))?(k="author",f=b[1],i=p=void 0):null!==(b=/^@([a-z0-1._\-]+)\/([a-z0-1._\-]+)$/i.exec(j))?(k="list",f=b[1],p=b[2],i=void 0):(k="search",i=j,p=f=void 0);c="https:"===document.location.protocol?"https://":"http://";switch(k){case "author":c+="api.twitter.com/1/statuses/user_timeline.json";
r={include_rts:d.retweets,screen_name:f,count:d.limit};break;case "list":c+="api.twitter.com/1/lists/statuses.json";r={page:1,include_rts:d.retweets,slug:p,owner_screen_name:f,per_page:d.limit};break;default:c+="search.twitter.com/search.json",r={q:i,rpp:d.limit}}d.refresh&&n.bind("mouseenter."+o+" mouseleave."+o,function(b){z[b.type==="mouseenter"?"pause":"resume"]()});g()})()}var l="tweed",o="plugin_"+l;e.fn[l]=function(m,j){var d=!1===m?"destroy":m,k=Array.prototype.slice.call(arguments,1),f=e.isPlainObject(j)?
e.extend({},e.fn[l].defaults,j):e.fn[l].defaults;return this.each(function(l,i){var j=e.data(i,o),g=j||e.data(i,o,new s(i,m,f));j&&e.isFunction(g[d])&&g[d].apply(g,k)})};e.fn[l].defaults={limit:5,retweets:1,linkify:1,refreshInterval:0,pauseOnHover:0,template:'<li><span class="text">{{tweet}}</span><br><a href="{{author_url}}" class="author">{{author}}</a> <a href="{{tweet_url}}" class="time">{{time}}</a></li>'}})(jQuery);
